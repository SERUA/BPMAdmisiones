<div style="margin-bottom:15px;" class="col-xs-8 col-xs-offset-2" ng-show="lstCampusByUser.length>1">
    <div class="col-xs-12">
        <select class="form-control" ng-model="filtroCampus" 
            ng-options="getCampusByGrupo(member) as getCampusByGrupo(member) for member in lstCampusByUser"
            ng-change="addFilter()"
            ng-disabled="navVar !== 'calendario'">
            <option style="display:none" value="">
                Seleccionar campus
            </option>
        </select>
    </div>
</div>

<div class="row" ng-show="navVar === 'calendario' && (filtroCampus !== '' || lstCampusByUser.length === 1) ">
    <div class="col-xs-12 text-right" style="margin-bottom: 10px; padding-right: 32px;">
        <button type="button" class="btn btn-primary" ng-click="initSesion()">Agendar nueva sesión</button>
    </div>
</div>

<div class="panel panel-danger col-md-12" ng-show="navVar === 'calendario'">
    <div class="panel-heading" style="background-color: #ff5900" align="center" >
        <strong style="color:white;">Calendario de entrevistas</strong>
    </div>
    <div id="scheduler_here" class="dhx_cal_container" style='width:100%; height:80vh; padding:10px;'>
        <div class="dhx_cal_navline">
            <div class="dhx_cal_prev_button">&nbsp;</div>
            <div class="dhx_cal_next_button">&nbsp;</div>
            <div class="dhx_cal_today_button"></div>
            <div class="dhx_cal_date"></div>
            <div class="dhx_cal_tab" name="day_tab" style="right:204px;"></div>
            <div class="dhx_cal_tab" name="week_tab" style="right:140px;"></div>
            <div class="dhx_cal_tab" name="month_tab" style="right:76px;"></div>
            <div class="dhx_cal_date"></div>
            <div class="dhx_minical_icon" id="dhx_minical_icon" ng-click="show_minical()">&nbsp;</div>
        </div>
        <div class="dhx_cal_header"></div>
        <div class="dhx_cal_data"></div>
    </div>
</div>

<div class="row" ng-show="navVar === 'sesion'">
    <div class="col-xs-8 col-xs-offset-2 text-center">
        <div class="col-xs-3 text-left">
            <div class="col-xs-12">
                <button type="button" ng-click="navVar = 'calendario'" class="btn btn-info"> Atras </button>
            </div>
        </div>
        <div class="col-xs-6">
            <h3 class="color-orange">Detalles de la sesión</h3>
        </div>
    </div> 
    <br>
    <div class="col-xs-8 col-xs-offset-2">
        <div class="form-group col-xs-12">
            <label class="control-label col-xs-12"> Nombre de sesión: </label>
            <div class="col-xs-12">
                <input class="form-control" ng-model="sesion.nombre">
            </div>
        </div>
        <div class="form-group col-xs-12">
            <label class="control-label col-xs-12"> Descripción: </label>
            <div class="col-xs-12">
                <!-- <input class="form-control" ng-model="sesion.descripcion_entrevista"> -->
               <textarea class="form-control" ng-model="sesion.descripcion_entrevista" style="height: 200px;"></textarea> 
            </div>
        </div>
        <div class="form-group col-xs-6">
            <label class="control-label col-xs-12"> Fecha:</label>
            <div class="col-xs-12">
                <input class="form-control" ng-if="!sesion.persistenceId" ng-model="sesion.fecha_entrevista" type="date" min="{{limiteFecha()}}">
                <input class="form-control" ng-disabled="sesion.persistenceId" ng-if="sesion.persistenceId" ng-model="sesion.fecha_entrevista_back" type="text">
            </div>
        </div>
        <div class="form-group col-xs-6">
            <label class="control-label col-xs-12"> Duración de las entrevistas: </label>
            <div class="col-xs-12">
                <select class="form-control" ng-disabled="sesion.persistenceId" ng-change="generarHoras(sesion.duracion_entrevista_minutos)" ng-model="sesion.duracion_entrevista_minutos" >
                    <option style="display: none" ng-value="">Seleccionar duración</option>
                    <option ng-repeat="opcion in lstDuracion" ng-value="opcion">{{opcion}}</option>
                </select>
            </div>
        </div>
        <div class="form-group col-xs-6">
            <label class="control-label col-xs-12"> Formato de la sesión: </label>
            <fieldset class="col-xs-12">
                <div>
                    <input 
                        type="radio"
                        id="chk_presencial"
                        ng-model="sesion.formato"
                        value="presencial"
                        name="formato"
                        ng-disabled="sesion.persistenceId"
                        ng-change="sesion.ubicacion = ''; sesion.liga = '';">
                    <label for="chk_presencial" style="font-weight: normal">
                        Presencial
                    </label>    
                </div>
                <div>
                    <input
                        type="radio"
                        id="chk_en_linea"
                        ng-model="sesion.formato"
                        value="linea"
                        name="formato"
                        ng-disabled="sesion.persistenceId"
                        ng-change="sesion.ubicacion = ''; sesion.liga = '';">
                    <label for="chk_en_linea" style="font-weight: normal">
                        En línea
                    </label>
                </div>
            </fieldset>
        </div>
        <div class="form-group col-xs-6" ng-if="sesion.formato === 'presencial'">
            <label class="control-label col-xs-12">Ubicación: </label>
            <div class="col-xs-12">
                <input class="form-control" ng-disabled="sesion.persistenceId" type="text" maxlength="250" ng-model="sesion.ubicacion" > 
            </div>
        </div>
        <div class="form-group col-xs-6" ng-if="sesion.formato === 'linea'">
            <label class="control-label col-xs-12"> Liga:</label>
            <div class="col-xs-12">
                <input class="form-control" ng-disabled="sesion.persistenceId" type="text" maxlength="250" ng-model="sesion.liga" > 
            </div>
        </div>

        <div class="col-xs-12">
            <div class="col-xs-12 text-center">
                <h4 class="color-orange">Responsables</h4>
            </div>
            <div class="row">
                <div class="form-group col-xs-6">
                    <label class="control-label col-xs-12">Responsable:</label>
                    <div class="col-xs-12">
                        <select class="form-control" ng-model="nuevoResponsable" ng-disabled="!sesion.duracion_entrevista_minutos">
                            <option >Seleccionar... </option>
                            <option ng-repeat="usuario in usuariosResponsables" ng-value="usuario.id">{{usuario.firstname + " " + usuario.lastname}}</option> 
                        </select>
                    </div>
                </div>
                <div class="col-xs-6 text-left">
                    <button class="btn btn-primary" style="margin-top: 24px;" ng-disabled="!sesion.duracion_entrevista_minutos" ng-click="agregarResponsable(nuevoResponsable)">Agregar responsable</button>
                </div>
            </div>
            <div class="col-xs-12">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Responsable</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="usuario in responsables">
                            <td>{{usuario.nombre}}</td>
                            <td>
                                <button class="btn btn-link" ng-click="getInfoResponsable(usuario)">
                                    <span class="glyphicon glyphicon-wrench"></span>
                                </button>
                                <button class="btn btn-link" ng-click="deleteResponsable(usuario)">
                                    <span class="glyphicon glyphicon-trash"></span>
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <br><br>
        <div class="col-xs-12">
            <div class="col-xs-12 text-right">
                <button class="btn btn-primary" type="button" ng-click="validate()">Guardar sesión</button>
            </div>
        </div>
    </div>
</div>

<div id="modalhorarios" class="modal fade" role="dialog" data-backdrop="static">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title"><strong>Horarios</strong></h4>
            </div>
            <div class="modal-body row">
                <div class="col-xs-6">
                    Responsable: {{ usuario.nombre }}
                    <div>
                        Licenciatura
                    </div> 
                    
                    <table class="table table-responisve table-striped">
                        <thead>
                            <tr>
                                <th>Carrera</th>
                            </tr>    
                        </thead>
                        <tbody>
                            <tr ng-repeat="carrera in compiladoCarrerassResponsable[usuario.responsable_id]; track by $index" >
                                <td>
                                    {{ carrera.nombre }}
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col-xs-6">
                    <div class="col-xs-12">
                        <div class="form-group">
                            <label>Licenciatura</label>
                            <multiselect key="nombre" label="nombre" class="input-xlarge" multiple="true" ng-model="carrerasResponsableString" options="c.nombre for c in lstGestionEscolar" change="selected(c)"></multiselect>
                        </div>
                    </div>
                    <table class="table table-striped">
                        <thead>
                           <tr>
                                <th>Horarios </th>
                                <th>Acciones </th>
                           </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="horario in horarios" ng-init="horarioIndex = $index">
                                <td class="text-center ">
                                    {{ horario.hora_inicio + "-" + horario.hora_fin}} 
                                </td>
                                <td class="text-center ">
                                    <div ng-repeat="responsable in horario.responsables" ng-init="responsableIndex = $index" ng-if="responsable.responsable_id === usuario.responsable_id">
                                        <button class="btn btn-success" ng-if="responsable.disponible_resp" type="button" ng-click="setDisponible(false, responsableIndex, horarioIndex)"> Disponible</button>
                                        <button class="btn btn-default" ng-if="!responsable.disponible_resp" type="button" ng-click="setDisponible(true, responsableIndex, horarioIndex)"> No disponible</button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="col-xs-12">
                    <!--<pre>{{ usuario | json }}</pre>-->
                </div>
            </div>
            <div class="modal-footer">
                <div class="col-xs-12 text-right">
                    <button type="button " class="btn btn-primary " data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
</div>